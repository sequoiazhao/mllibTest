package com.SearchLtr

import org.apache.spark.sql.functions._

/**
  * @author zhaoming on 2018-04-11 15:00
  **/
object NingWSClientTest {
  def main(args: Array[String]): Unit = {
    val ss = Array("sss","ttt","eeee")
     println(ss.mkString)


    println("ttt")
    import play.api.libs.ws.ning.NingWSClient
    import scala.concurrent.ExecutionContext.Implicits.global
    
    val searchx =
      """
        {
                    "query": {
                      "bool": {
                        "filter": [
                          {
                            "terms": {
                              "_id": ["1845873","3876623","11012293372","2298651","11013548160","11013392721","1572316","1974267","2150681","1334997","282136","11012802342","359824","11013775192","11012303645","2191506","2290858","1910440","2277207","2049053","3720904","11013392722","11013451305","1759499","2279666","358783","1973765","1365692","1565505","1332395","1481615","11012742695","11013858100","11013876067","1717808","965431","11013316672","2184061","1568916","11013799259","11013392723","2145511","11013914889","965382","1771908","358035","2149257","357948","358018","11013691105","2146044","11013580395","11013954280","11012990271","2184051","1483827","2222361","2225028","11013563033","1334706","359726","11012802441","11013835873","570662","282478","11013392719","11013547800","282383","2173782","2243416","3369969","11012925070","3835627","1584867","2149254","460355","2178481","3734606","11012831504"]
                            }
                          },
                          {
                            "sltr": {
                              "_name": "logged_featureset",
                              "featureset": "unionsearch_vod_similarity_features",
                              "params": {
                                "keywords": "BX"
                              }
                            }
                          }
                        ]
                      }
                    },
                    "ext": {
                      "ltr_log": {
                        "log_specs": {
                          "name": "log_entry1",
                          "named_query": "logged_featureset"
                        }
                      }
                    },
                    "_source": {
        		"includes": "log_entry1"
                  }
        }
      """.stripMargin

    val wsClient = NingWSClient()
    val result2 = wsClient.url("http://10.18.210.224:9600/unionsearch_vod_online/_search?size=100")
      .withHeaders(("Content-Type", "application/json"))
     // .withRequestTimeout(10000)
      .post(searchx)
      .map { wsResponse =>
          wsResponse.body
      }

    result2.foreach(println)
//    val ss = result2.value.mkString
//    println(ss)
    //val tt = result2.
//   val ss = result2.asInstanceOf[Array[String]]
//    ss.foreach(println)

//
//    result2.map(x=>
//    tt.append(x)
//    )
//    println(tt.toString)






  }

}

//    val sdd = sc.makeRDD(data.toSeq)
//    sdd.saveAsTextFile("D:\\dataframeData\\002")

// sdata.toJavaRDD.saveAsTextFile("D:\\dataframeData\\003")
// sdata.toJavaRDD.saveAsTextFile("hdfs://namenode-2:8020/user/spark/model/003")

//    val sda = sc.textFile("D:\\dataframeData\\003")
//    sda.foreach(println)

//
//    sdata.show(2000,false)
//    sdata.saveAsParquetFile("D:\\dataframeData\\001")

//    val mediaor = Seq(("AFLXQ", Array("11012830495", "3603925")),
//      ("AOTEMANPU", Array("11013305513", "11013451132", "11012403658", "1588429")),
//      ("AQZSQ", Array("2074852", "11012471615", "3552493", "11012911119")),
//      ("BAIBIANMADING", Array("1636434", "11012802823", "11012795843", "3843337", "11013914858", "3843338")),
//      ("BBZX", Array("11013419233", "1354276", "282646", "11012227098", "11012671879", "2292354")),
//      ("BULUKE", Array("11013569818", "11012708997", "11012847170", "3780653", "11012847439", "11013583227", "11012729824", "11012995458", "11013548054")),
//      ("CFS", Array("11012254037", "11013720563", "11012995240", "3957750", "291063", "11013552040", "3985135")),
//      ("CHENGO", Array("11013559973", "11012801785", "11012644623", "11013027704", "11013528782", "11012264612", "4028037", "11012308569", "11013538473")),
//      ("CJKJ", Array("11013149926", "11013562576", "11013014793", "11013914494", "11012881500", "11013564699")),
//      ("DACHANG", Array("1568540", "11013878210", "1568519", "11013926232", "11013916419", "11013944098", "11013926233", "11013952724", "11013972445")),
//      ("DAHUAXI", Array("2185941", "11012720539", "11012762753", "2093128", "2253448", "2234401", "11012733721", "11012494832", "11012743693")),
//      ("DAM", Array("50698", "11013042747", "11013935359", "11013798190", "11012209440", "11013017246", "11013612145", "1564787", "281987")),
//      ("DAOXIAN", Array("2112170", "2107825", "2118983", "2108164", "2082638", "11012617072", "2100597", "2101526", "3942920")),
//      ("DCZWD", Array("3982906", "3976638", "3975905", "3980245", "3980728", "3982511", "3984875")),
//      ("DIXIN", Array("11012802456", "11012493326", "3646342", "11013728312", "11013729492", "11013540979", "4021973", "3646343", "11013728371")),
//      ("DLND", Array("3693178", "3909107", "3909102", "2298368", "3836581", "3647464", "3909088", "11012689005", "3909150")),
//      ("DLNDF", Array("3919705", "3909147", "3909107", "3909102", "3960693", "3836581", "3909088", "3909150", "3952327")),
//      ("DTX", Array("2214622", "11012488363", "11013907965", "11012727270", "1712557", "11012802019", "11013885565", "3950674", "2214636")),
//      ("EVA", Array("11013652611", "2121517", "2288126", "2137179", "2130428", "11012467870", "3748827", "2118622", "2266132")),
//      ("FENGSHUIY", Array("1904437", "11013419303", "1904451")),
//      ("FJL", Array("11013894247", "11013904893", "2253442", "11013904335", "11013904680", "11012263970", "11013531721", "11013895744", "11013612874")),
//      ("GCWA", Array("1445089", "1344794", "3577237", "3973339", "1700741", "11013164196", "1414736", "3619726", "1548983")),
//      ("GCWXLM", Array("11012460062", "11012460536")),
//      ("GE", Array("2272342", "11012708670", "3759410", "11013718830", "2214622", "11013834942", "11013834887", "11013914852", "3817361")),
//      ("HCWJ", Array("11013211368", "3702549", "3809846", "3692822", "11012724277", "3767848", "11013423162", "11013963957")),
//      ("HFN", Array("11013935573", "11013653285", "11013757380", "11013565480", "11013182110", "11013757381", "11013564089", "11013585077", "11013573426")),
//      ("JDQSQGJ", Array("11012753090")),
//      ("JFHJ", Array("11013815852", "1970023", "2063106", "11013805992", "3948688", "3979026", "2136447", "11012275985", "11012917226")),
//      ("JIESHA", Array("11013025503", "11013943086", "11013499942", "11012993806", "11012248540", "11013451276", "11013952476", "11013689791", "11013963985", "11013552075"))) //rambo
//   val media = sc.makeRDD(mediaor)
//med


//
//val searchx =
//"""{
//    "query": {
//      "bool": {
//        "filter": [
//          {
//            "terms": {
//              "_id": """ + mex._2.mkString("[\"", "\",\"", "\"]") +
//"""
//          }
//        },
//        {
//          "sltr": {
//            "_name": "logged_featureset",
//            "featureset": "unionsearch_vod_similarity_features",
//            "params": {
//              "keywords": """ + "\"" + mex._1 + "\"" +
//"""
//            }
//          }
//        }
//      ]
//    }
//  },
//  "ext": {
//    "ltr_log": {
//      "log_specs": {
//        "name": "log_entry1",
//        "named_query": "logged_featureset"
//      }
//    }
//  }
//}""".stripMargin